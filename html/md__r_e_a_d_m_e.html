<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arches v2: Arches</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Arches v2
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Arches</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a> Arches is a general-purpose and fast cycle-level hardware simulator.</p>
<p>The name is a pun on being able to simulate various architectures and on Arches National Park, Utah (it being traditional at the University of Utah to name software projects after Utah or Salt Lake City features).</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Setup (Simulator)</h1>
<p>Visual Studio Components needed:</p><ul>
<li>Windows Universal CRT SDK<ul>
<li>Install using VS Installer</li>
</ul>
</li>
<li>Windows 8.1 sdk<ul>
<li>Download from <a href="https://go.microsoft.com/fwlink/p/?LinkId=323507">https://go.microsoft.com/fwlink/p/?LinkId=323507</a></li>
</ul>
</li>
<li>MSVC v142 - VS 2020 C++ x64/x86 build tools (v14.16)<ul>
<li>Install via VS Installer; use the correct build tools for your environment ie. x64/x86</li>
</ul>
</li>
</ul>
<p>To build the simulator, simply open <code>arches.sln</code> in Visual Studio and batch build all.</p>
<p>The simulator itself will be built at <code>.build/[platform]/[config]/arches-sim.lib</code>, and any included samples using it will be built as executables in the same directory.</p>
<p>To run a sample, such as "sim-sample-mips", simply select it in the solution explorer and run it.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Setup (RISCV, Ubuntu Linux)</h1>
<p>Testing programs on the framework requires the use of a RISC-V Cross-Compiler. Fortunately, many many people have devoted numerous hours to getting a decent RISC-V cross compiler implemented using GCC; this is available <a href="https://github.com/riscv/riscv-gnu-toolchain">here</a>. For our own testing, these are the instructions we followed: </p><div class="fragment"><div class="line">$ git clone https://github.com/riscv/riscv-gnu-toolchain</div>
<div class="line">$ cd riscv-gnu-toolchain</div>
<div class="line">$ git submodule update --init --recursive</div>
<div class="line">$ sudo apt-get install autoconf automake autotools-dev curl python3 libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev</div>
<div class="line">$ ./configure --prefix=/opt/riscv --with-arch=rv64imfa --with-abi=lp64f</div>
<div class="line">$ make -j$(nproc)</div>
<div class="line">$ echo -e &quot;export PATH=\&quot;/opt/riscv/bin:$PATH\&quot;&quot; &gt;&gt; ~/.bashrc</div>
<div class="line">$ . ~/.bashrc</div>
</div><!-- fragment --><p> After these steps are completed, users are able to use <code>riscv64-uknown-elf-gcc</code> to compile C code and <code>riscv64-unknown-elf-g++</code> to compile C/C++ code.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Adding custom instructions</h1>
<p>A key reason we used RISC-V over other research languages (i.e. MIPS) was the ease with which RISC-V can be extended. This allows researchers to use our framework to test novel hardware designs that may rely on custom instructions for drastic performance improvements. It's important to note that this method allows progams using custom instructions to compile; however, it doesn't act as a true cross-compiler, i.e. users will need to use inline ASM to include their custom instructions.</p>
<p>To add custom instructions, we followed the guide available <a href="https://nitish2112.github.io/post/adding-instruction-riscv/">here</a>. Since the time of this guide's writing, there have been a few notable changes to the build tree of the riscv-gnu-toolchain, so we will only note the differences below:</p><ul>
<li>Use <code>riscv-gnu-toolchain/riscv-binutils/include/opcode/riscv-opc.h</code> instead of <code>riscv-gnu-toolchain/riscv-binutils-gdb/include/opcode/riscv-opc.h</code>.</li>
<li>Similarly, use <code>riscv-gnu-toolchain/riscv-binutils/opcodes/riscv-opc.c</code> instead of <code>riscv-gnu-toolchain/riscv-binutils-gdb/opcodes/riscv-opc.c</code>. As the original guide notes, after the custom instruction has been added the toolchain will need to be rebuilt. This can be easily accomplished by running the following: <div class="fragment"><div class="line">$ cd {PATH/TO/RISCV_GNU_TOOLCHAIN}</div>
<div class="line">$ make clean</div>
<div class="line">$ ./configure --prefix=/opt/riscv --with-arch=rv64g --with-abi=lp64d</div>
<div class="line">$ make -j$(nproc)</div>
</div><!-- fragment --> After rebuilding, the user should be able to run the cross-compiled programs with their custom instructions on the Arches framework, assuming they have extended the implementation of the RISC-V ISA provided by Arches to contain their custom instruction.</li>
</ul>
<p>More details about the RISC-V ISA are available <a href="https://github.com/riscv/riscv-isa-manual/releases/download/Ratified-IMFDQC-and-Priv-v1.11/riscv-privileged-20190608.pdf">by reading the specification</a>, but it's expected that users are at least familiar with RISC-V before they attempt to implement custom instructions.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Contributing</h1>
<p>Follow the coding style in the existing code. Additionally, aim for cleanliness above all else. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
